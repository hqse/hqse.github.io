<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style type="text/css">html,body,#map_canvas{width: 100%;height: 100%;overflow: hidden;margin:0;}</style>
<script language="javascript" src="http://api.tianditu.com/js/maps.js"></script>
<script language="javascript">

var $D=document;
function $(i){return $D.getElementById(i);}
var map;
var mmp; 
var minfo;
var zoomLevel = 9;

function initialize()
{
map=new TMap("map_canvas");
map.centerAndZoom(new TLngLat(114.274294,30.558462),zoomLevel);
map.setZoomLevels([1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]);
var scale = new TScaleControl();
map.addControl(scale);
scale.setLeft(10);
scale.setTop(20);

var control = new TMapTypeControl();
map.addControl(control);
map.setMapType(TMAP_HYBRID_MAP);

map.enableDoubleClickZoom();
map.enableHandleMouseScroll();

minfo = $("info");
mmp = $("mp");
minfo.innerHTML=zoomLevel;
var mapclick = TEvent.addListener(map,"click",function(p){var lnglat = map.fromContainerPixelToLngLat(p);mmp.value=lnglat.getLng() + '|' + lnglat.getLat();});
var mapend = TEvent.addListener(map,"zoomend",function(p){minfo.innerHTML=p;});

}

       function setZ(){
          var t=parseInt($("mz").value); 
         	if(t>=1&&t<=18){
        	zoomLevel=t;
          map.setZoom(zoomLevel);
       }}

       function addOver(){
           var b = mmp.value.split("|");
           var i = parseFloat(b[0]);
           var j = parseFloat(b[1]);
           var marker = new TMarker(new TLngLat(i,j));
           map.addOverLay(marker);
           map.panTo(new TLngLat(i,j));
       }

function addOver2(){
var t = mmp.value.split("|");
mmp.value ="";
var i,j,k,l;
i = parseFloat(t[0]);
j = parseFloat(t[1]);
k = parseFloat(t[2]);
l = parseFloat(t[3]);
           var points = [];
           points.push(new TLngLat(j,i));
           points.push(new TLngLat(l,i));
           points.push(new TLngLat(l,k));
           points.push(new TLngLat(j,k));
           var polygon = new TPolygon(points,{strokeColor:"red", strokeWeight:4, strokeOpacity:1.0, fillOpacity:0.0}); 
           map.addOverLay(polygon);
           map.setViewport(points);
       }

       function clearOver(){
           map.clearOverLays();
       }

</script>
<title>天地图【WGS-84】</title>
</head>
<body onload="initialize()">
<div style="width: 100%;height: 40px;overflow: hidden;margin:0;">
<p align=right><font color=red><b>层：</b></font><span id="info"></span>&nbsp;
<input type=button id=upd onclick=map.zoomIn() value=放>
<input type=button id=dnd onclick=map.zoomOut() value=缩>

<input type=text value="14" id=mz size=1> <input type=button onclick=setZ() value=层 id=mzb>
<input type=text value="武汉" id=mcity size=6> <input type=button onclick=getBoundary() value=区>
<input type=text value="" id=mp> <input type=button onclick=addOver2() value=显示 id=mpb> <input type=button onclick=clearOver() value=清>
</p></div><div id="map_canvas"></div>
</body></html>
